extensions:
  - addsTo:
      pack: codeql/javascript-all
      extensible: sinkModel
    data:
      - ["S3ClientV3", "ReturnValue.Member[send].Argument[0]", "sql-injection"]
      - ["S3ClientV2", "ReturnValue.Member[selectObjectContent].Argument[0].Member[Expression]", "sql-injection"]

  - addsTo:
      pack: codeql/javascript-all
      extensible: summaryModel
    data:
      - ["@aws-sdk/client-s3", "Member[SelectObjectContentCommand]", "Argument[0].Member[Expression]", "ReturnValue", "taint"]

  - addsTo:
      pack: codeql/javascript-all
      extensible: typeModel
    data:
      - ["S3ClientV3", "@aws-sdk/client-s3", "Member[S3Client]"]
      - ["S3ClientV2", "aws-sdk", "Member[S3]"]

  - addsTo:
      pack: codeql/javascript-all
      extensible: sourceModel
    data:
      - ["S3ClientV3", "ReturnValue.Member[send].ReturnValue.Awaited", "database-access-result"]
      - ["S3ClientV2", "ReturnValue.Member[getObject].ReturnValue.Member[promise].ReturnValue.Awaited", "database-access-result"]
      - ["S3ClientV2", "ReturnValue.Member[getObject].Argument[1].Parameter[1]", "database-access-result"]
